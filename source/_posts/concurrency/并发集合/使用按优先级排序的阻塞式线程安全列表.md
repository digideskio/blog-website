category: 
- concurrency
tag:
- collection
title: PriorityBlockingQueue使用按优先级排序的阻塞式线程安全列表
---
# PriorityBlockingQueue

`PriorityBlockingQueue`是一个支持优先级的无界队列.默认情况下元素采取自然顺序排列,也可以通过比较器`comparator`来指定元素的排序规则.元素按照升序排列,这与构造队列时,提供的参数有关.

使用提取方法时,队列将返回头部,具有最高优先级(或最低优先级,这与排序规则有关)的元素.如果多个元素具有相同的优先级,则同等优先级间的元素获取次序无特殊说明.

优先级队列使用的是一种可扩展的数组结构,一般可以认为这个队列是无界的.当需要新添加一个元素时,如果此时数组已经被填满,优先队列将会自动扩充当前数组.(一般认为是,先分配一个原数组一定倍数空间的数组,之后将原数组中的元素拷贝到新分配的数组中,释放原数组的空间).

如果使用优先级队列的`iterator`变量队列时,不保证遍历次序按照优先级大小进行.因为优先级队列使用的是堆结构.如果需要按照次序遍历需要使用`Arrays.sort(pq.toArray())`.

在`PriorityBlockingQueue`的实现过程中聚合了`PriorityQueue`的一个实例,并且优先队列的操作完全依赖与`PriorityQueue`的实现.在`PriorityQueue`中使用了一个一维数组来存储相关的元素信息.一维数组使用最小堆算法进行元素添加.`PriorityBlockingQueue` 按优先级排序的阻塞时线程安全列表

与`LinkedBlockingDeque` 一样,它也是一个阻塞时并发列表
